# إعداد Firebase للمصادقة - دليل إصلاح مشاكل التسجيل

## المشكلة المحتملة
إذا كان تسجيل الدخول يعمل ولكن إنشاء الحسابات الجديدة لا يعمل، فالمشكلة غالباً في إعدادات Firebase Console.

## الحل: تفعيل مصادقة البريد الإلكتروني/كلمة المرور

### 1. الدخول إلى Firebase Console
1. اذهب إلى [Firebase Console](https://console.firebase.google.com/)
2. اختر مشروع `alfaree-615b6`
3. اختر "Authentication" من القائمة الجانبية

### 2. تفعيل Email/Password Authentication
1. اختر تبويب "Sign-in method"
2. ابحث عن "Email/Password" في قائمة مقدمي الخدمة
3. اضغط على "Email/Password"
4. فعّل الخيار الأول "Enable"
5. اضغط "Save"

### 3. التحقق من إعدادات الأمان
1. اختر تبويب "Settings" ثم "Authorized domains"
2. تأكد من إضافة النطاقات التالية:
   - `localhost`
   - `127.0.0.1`
   - أي نطاق آخر تستخدمه للتطوير

### 4. فحص قواعد قاعدة البيانات
1. اذهب إلى "Realtime Database"
2. اختر تبويب "Rules"
3. تأكد من أن القواعد تسمح للمستخدمين المصادق عليهم بالكتابة:

```json
{
  "rules": {
    "users": {
      "$uid": {
        ".read": "$uid === auth.uid",
        ".write": "$uid === auth.uid"
      }
    }
  }
}
```

## اختبار الإصلاح

### استخدام أدوات التشخيص
1. افتح `/debug-auth.html` في المتصفح
2. اختبر إنشاء مستخدم جديد
3. راقب رسائل الخطأ في Console

### استخدام المستخدم التجريبي
1. افتح التطبيق الرئيسي
2. اضغط على "إنشاء/دخول مستخدم تجريبي"
3. يجب أن يعمل بدون أخطاء

## رسائل الخطأ الشائعة

### `auth/operation-not-allowed`
- **السبب**: Email/Password authentication غير مفعل في Firebase Console
- **الحل**: اتبع الخطوات أعلاه لتفعيله

### `auth/email-already-in-use`
- **السبب**: البريد الإلكتروني مسجل بالفعل
- **الحل**: استخدم بريد إلكتروني مختلف أو اضغط "دخول مستخدم تجريبي فقط"

### `auth/weak-password`
- **السبب**: كلمة المرور أقل من 6 أحرف
- **الحل**: استخدم كلمة مرور أطول

## ملفات التشخيص المتوفرة

1. **debug-auth.html** - صفحة تشخيص شاملة
2. **src/js/test-auth.js** - أدوات إنشاء مستخدمين تجريبيين
3. **src/js/auth.js** - محدث مع رسائل خطأ أفضل

## تجربة التطبيق بعد الإصلاح

1. افتح `src/index.html`
2. اضغط "إنشاء حساب جديد"
3. ادخل بريد إلكتروني وكلمة مرور
4. يجب أن يعمل التسجيل بنجاح

إذا استمرت المشاكل، استخدم صفحة debug-auth.html لمزيد من التشخيص.
